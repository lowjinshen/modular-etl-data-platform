{
  "table_name": "silver_orders",
  "source_table": "bronze_orders",
  "source_system": "order_management",
  "load_type": "upsert",
  "description": "Cleansed and deduplicated order transactions",
  "primary_keys": ["order_id"],
  "partition_by": ["order_date"],
  "incremental_column": "ingestion_date",
  "columns": [
    {
      "name": "order_id",
      "datatype": "bigint",
      "nullable": false,
      "description": "Business key - unique order identifier",
      "transformation": null
    },
    {
      "name": "customer_id",
      "datatype": "bigint",
      "nullable": false,
      "description": "Foreign key to customer",
      "transformation": null
    },
    {
      "name": "order_date",
      "datatype": "date",
      "nullable": false,
      "description": "Order date (partition key)",
      "transformation": null
    },
    {
      "name": "order_time",
      "datatype": "string",
      "nullable": true,
      "description": "Order time HH:MM:SS",
      "transformation": "trim(order_time)"
    },
    {
      "name": "order_status",
      "datatype": "string",
      "nullable": false,
      "description": "Status: pending, processing, shipped, delivered, cancelled",
      "transformation": "lower(trim(order_status))"
    },
    {
      "name": "payment_method",
      "datatype": "string",
      "nullable": false,
      "description": "Payment method used",
      "transformation": "lower(trim(payment_method))"
    },
    {
      "name": "shipping_address",
      "datatype": "string",
      "nullable": true,
      "description": "Shipping street address",
      "transformation": "trim(shipping_address)"
    },
    {
      "name": "shipping_city",
      "datatype": "string",
      "nullable": true,
      "description": "Shipping city",
      "transformation": "initcap(trim(shipping_city))"
    },
    {
      "name": "shipping_state",
      "datatype": "string",
      "nullable": true,
      "description": "Shipping state",
      "transformation": "upper(trim(shipping_state))"
    },
    {
      "name": "shipping_postal_code",
      "datatype": "string",
      "nullable": true,
      "description": "Shipping postal code",
      "transformation": "trim(shipping_postal_code)"
    },
    {
      "name": "order_total",
      "datatype": "decimal(10,2)",
      "nullable": true,
      "description": "Total order amount",
      "transformation": null
    },
    {
      "name": "tax_amount",
      "datatype": "decimal(10,2)",
      "nullable": true,
      "description": "Tax amount",
      "transformation": null
    },
    {
      "name": "shipping_fee",
      "datatype": "decimal(10,2)",
      "nullable": true,
      "description": "Shipping fee",
      "transformation": null
    },
    {
      "name": "discount_code",
      "datatype": "string",
      "nullable": true,
      "description": "Discount code applied",
      "transformation": "upper(trim(discount_code))"
    },
    {
      "name": "discount_amount",
      "datatype": "decimal(10,2)",
      "nullable": true,
      "description": "Discount amount",
      "transformation": null
    },
    {
      "name": "notes",
      "datatype": "string",
      "nullable": true,
      "description": "Order notes",
      "transformation": "trim(notes)"
    },
    {
      "name": "updated_timestamp",
      "datatype": "timestamp",
      "nullable": false,
      "description": "When this record was last updated in Silver",
      "transformation": "current_timestamp()"
    },
    {
      "name": "record_source",
      "datatype": "string",
      "nullable": false,
      "description": "Source system identifier",
      "transformation": "'order_management'"
    }
  ],
  "data_quality_rules": {
    "null_checks": [
      "order_id",
      "customer_id",
      "order_date",
      "order_status",
      "payment_method"
    ],
    "uniqueness_checks": [
      "order_id"
    ],
    "value_constraints": {
      "order_status": ["pending", "processing", "shipped", "delivered", "cancelled"],
      "order_total": ">= 0",
      "tax_amount": ">= 0",
      "shipping_fee": ">= 0",
      "discount_amount": ">= 0"
    },
    "format_validations": {
      "order_time": "^([0-1][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$"
    },
    "referential_integrity": {
      "customer_id": {
        "reference_table": "silver_customers",
        "reference_column": "customer_id"
      }
    }
  }
}
